@startuml
skinparam sequenceMessageAlign center
autoactivate on

actor "User" as User
participant "UpdateLibraryScreen" as Screen
participant "Actions" as Action
participant "LibraryService" as Service
participant "API" as API
participant "Reducer" as Store

note right of User
  User is already on
  UpdateLibraryScreen
  in "Edit" mode
end note

User -> Screen : Edit details & Click "Save"
note right of Screen
  Validates inputs
  (Name, Address, Open Days)
end note

Screen -> Action : updateLibraryAction(dispatch, id, data)

Action -> Store : dispatch({ type: SET_LOADING, payload: true })
return State Updated (isLoading = true)

Action -> Service : UpdateLibrary(id, data)
Service -> API : PUT /v1/library/{id}
return 200 OK (Success)

note right of Action
  **Refetch Pattern:**
  Reloads list to capture
  server-side changes
end note

Action -> Action : fetchLibrariesAction(dispatch)
    Action -> Service : GetLibraries()
    Service -> API : GET /v1/library
    return List of Libraries

    Action -> Store : dispatch({ type: FETCH_LIBRARIES_SUCCESS, list })
    return State Updated
return Data Refreshed

return Promise Resolved

Screen -> User : Alert("Success", "Library details updated")
User -> Screen : Click "OK" (Implicit)

Screen -> Screen : navigation.goBack()
return Navigate to Library List

@enduml